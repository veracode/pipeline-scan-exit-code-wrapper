# Veracode Pipeline-Scan Pattern Configuration
# Format: PATTERN_NAME|REGEX_PATTERN|EXIT_CODE
# 
# New exit code taxonomy (negative values to avoid colliding with flaw-count range 1-200):
# -10 to -19: Timeouts
# -20 to -29: Auth/Org issues
# -30 to -39: Network/Transport issues
# -40 to -49: Configuration issues
# -50 to -59: Packaging/Artifact issues
# -60 to -69: Engine/Scan execution issues
# -70 to -79: Results/Post-processing issues

# Timeouts
TIMEOUT_DEFAULT|exceeded.*default.*60.*min.*limit|-10
TIMEOUT_DEFAULT|timeout.*default.*60|-10
TIMEOUT_USER|exceeded.*timeout.*value|-11
TIMEOUT_USER|timeout.*exceeded|-11

# Auth / Org
AUTH_INVALID_CREDENTIALS|401|-20
AUTH_INVALID_CREDENTIALS|unauthorized|-20
AUTH_INVALID_CREDENTIALS|invalid credential|-20
AUTH_INVALID_CREDENTIALS|credential invalid|-20
AUTH_INVALID_CREDENTIALS|credentials invalid|-20
AUTH_INVALID_CREDENTIALS|credentials are invalid|-20
AUTH_INVALID_CREDENTIALS|invalid key|-20
AUTH_INVALID_CREDENTIALS|key invalid|-20
AUTH_INVALID_CREDENTIALS|invalid id|-20
AUTH_INVALID_CREDENTIALS|id invalid|-20
AUTH_INVALID_CREDENTIALS|api.*id.*bad|-20
AUTH_INVALID_CREDENTIALS|api.*key.*bad|-20
AUTH_INVALID_CREDENTIALS|api.*id.*expired|-20
AUTH_INVALID_CREDENTIALS|api.*key.*expired|-20
AUTH_INSUFFICIENT_PERMISSIONS|403|-21
AUTH_INSUFFICIENT_PERMISSIONS|forbidden|-21
AUTH_INSUFFICIENT_PERMISSIONS|insufficient permission|-21
AUTH_INSUFFICIENT_PERMISSIONS|not authorized|-21
AUTH_INSUFFICIENT_PERMISSIONS|permission denied|-21
AUTH_INSUFFICIENT_PERMISSIONS|lacks.*app.*rights|-21
AUTH_INSUFFICIENT_PERMISSIONS|lacks.*scan.*rights|-21
ACCOUNT_RATE_LIMIT|429|-22
ACCOUNT_RATE_LIMIT|rate limit|-22
ACCOUNT_RATE_LIMIT|too many requests|-22
ACCOUNT_RATE_LIMIT|quota exceeded|-22
ACCOUNT_RATE_LIMIT|platform.*throttling|-22

# Network / Transport
NET_DNS|getaddrinfo|-30
NET_DNS|enotfound|-30
NET_DNS|dns|-30
NET_DNS|name or service not known|-30
NET_DNS|hostname not found|-30
NET_DNS|cannot resolve host|-30
NET_TLS|tls|-31
NET_TLS|ssl|-31
NET_TLS|pkix|-31
NET_TLS|certificate|-31
NET_TLS|x509|-31
NET_TLS|cert.*invalid|-31
NET_TLS|cert.*expired|-31
NET_TLS|ssl.*handshake|-31
NET_TLS|tls.*handshake|-31
NET_TLS|cert.*validation|-31
NET_PROXY|proxy|-32
NET_PROXY|407 proxy|-32
NET_PROXY|proxy auth|-32
NET_PROXY|proxy required|-32
NET_PROXY|proxy.*connectivity|-32

# Configuration (caller)
CONFIG_INVALID_PARAM|bad.*cli.*arg|-40
CONFIG_INVALID_PARAM|mutually exclusive|-40
CONFIG_INVALID_PARAM|invalid.*parameter|-40
CONFIG_INVALID_PARAM|invalid.*argument|-40
CONFIG_POLICY_REFERENCE_NOT_FOUND|policy.*not.*found|-41
CONFIG_POLICY_REFERENCE_NOT_FOUND|ruleset.*missing|-41
CONFIG_POLICY_REFERENCE_NOT_FOUND|named.*policy.*missing|-41
CONFIG_BASELINE_MISSING|baseline.*file.*not.*found|-42
CONFIG_BASELINE_MISSING|baseline.*path.*not.*found|-42
CONFIG_BASELINE_MISSING|baseline.*unreadable|-42
CONFIG_THRESHOLD_CONFLICT|conflicting.*fail.*on|-43
CONFIG_THRESHOLD_CONFLICT|threshold.*conflict|-43

# Packaging / Artifact
PKG_ARTIFACT_NOT_FOUND|no such file|-50
PKG_ARTIFACT_NOT_FOUND|not found|-50
PKG_ARTIFACT_NOT_FOUND|enoent|-50
PKG_ARTIFACT_NOT_FOUND|cannot open|-50
PKG_ARTIFACT_NOT_FOUND|no analyzable files|-50
PKG_ARTIFACT_NOT_FOUND|file not found|-50
PKG_ARTIFACT_NOT_FOUND|built.*package.*missing|-50
PKG_ARTIFACT_NOT_FOUND|path.*missing|-50
PKG_TOO_LARGE|size exceed|-51
PKG_TOO_LARGE|too large|-51
PKG_TOO_LARGE|quota exceeded|-51
PKG_TOO_LARGE|exceeds.*limit|-51
PKG_TOO_LARGE|exceeds.*size.*limit|-51
PKG_UNSUPPORTED_LANG|unsupported lang|-52
PKG_UNSUPPORTED_LANG|unsupported file|-52
PKG_UNSUPPORTED_LANG|unsupported archive|-52
PKG_UNSUPPORTED_LANG|language not supported|-52
PKG_UNSUPPORTED_LANG|no supported files|-52
PKG_EXCLUDE_RULES_ELIMINATED_ALL|exclude.*removed.*all|-53
PKG_EXCLUDE_RULES_ELIMINATED_ALL|glob.*removed.*all|-53

# Engine / Scan execution
ENGINE_PARSER_ERROR|parse error|-60
ENGINE_PARSER_ERROR|parser error|-60
ENGINE_PARSER_ERROR|engine error|-60
ENGINE_PARSER_ERROR|syntax error|-60
ENGINE_PARSER_ERROR|ast.*parse.*error|-60
ENGINE_PARSER_ERROR|preprocessing.*error|-60
ENGINE_RULEPACK_INCOMPATIBLE|ruleset.*version.*mismatch|-61
ENGINE_RULEPACK_INCOMPATIBLE|rulepack.*incompatible|-61
ENGINE_RULEPACK_INCOMPATIBLE|ruleset.*incompatible|-61
ENGINE_PARTIAL_SCAN|partial scan|-62
ENGINE_PARTIAL_SCAN|scan.*completed.*with.*modules.*skipped|-62
ENGINE_PARTIAL_SCAN|degraded.*scan|-62

# Results / Post-processing
RESULT_UPLOAD_FAILED|upload fail|-70
RESULT_UPLOAD_FAILED|post failed|-70
RESULT_UPLOAD_FAILED|upload error|-70
RESULT_UPLOAD_FAILED|results failed|-70
RESULT_UPLOAD_FAILED|results.*couldnt.*be.*posted|-70
RESULT_UPLOAD_FAILED|api.*post.*failed|-70
RESULT_WRITE_FAILED|couldnt.*write.*results|-71
RESULT_WRITE_FAILED|write.*results.*failed|-71
RESULT_WRITE_FAILED|permissions.*error|-71
RESULT_WRITE_FAILED|disk.*full|-71
RESULT_FORMAT_ERROR|sarif.*transform.*failed|-72
RESULT_FORMAT_ERROR|json.*transform.*failed|-72
RESULT_FORMAT_ERROR|format.*error|-72
